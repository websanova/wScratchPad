/*! wScratchPad - v2.1.0-dev - 2023-07-11 */
!function(a){"use strict";function o(t,s){this.$el=a(t),this.options=s,this.init=!1,this.enabled=!0,this._generate()}o.prototype={_generate:function(){if(!a.support.canvas)return this.$el.append("Canvas is not supported in this browser."),!0;this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),"static"===this.$el.css("position")&&this.$el.css("position","relative"),this.$img=a('<img src=""/>').attr("crossOrigin","").css({position:"absolute",width:"100%",height:"100%"}),this.$scratchpad=a(this.canvas).css({position:"absolute",width:"100%",height:"100%"}),this.$scratchpad.bindMobileEvents(),this.$scratchpad.on("mousedown",a.proxy(function(t){if(!this.enabled)return!0;this.canvasOffset=a(this.canvas).offset(),this.scratch=!0,this._scratchFunc(t,"Down")},this)).on("mousemove",a.proxy(function(t){this.scratch&&this._scratchFunc(t,"Move")},this)).on("mouseup",a.proxy(function(t){this.scratch&&(this.scratch=!1,this._scratchFunc(t,"Up"))},this)),a(document).on("mouseup",a.proxy(function(t){this.scratch&&(this.scratch=!1,this._scratchFunc(t,"Up"))},this)),this._setOptions(),this.$el.append(this.$img).append(this.$scratchpad),this.init=!0,this.reset()},reset:function(){var t=this,s=Math.ceil(this.$el.innerWidth()),i=Math.ceil(this.$el.innerHeight()),e=window.devicePixelRatio||1;this.pixels=s*i,this.$scratchpad.attr("width",s).attr("height",i),this.canvas.setAttribute("width",s*e),this.canvas.setAttribute("height",i*e),this.ctx.scale(e,e),this.pixels=s*e*i*e,this.$img.hide(),this.options.bg&&("#"===this.options.bg.charAt(0)?this.$el.css("backgroundColor",this.options.bg):(this.$el.css("backgroundColor",""),this.$img.attr("src",this.options.bg))),this.options.fg&&("#"===this.options.fg.charAt(0)?(this.ctx.fillStyle=this.options.fg,this.ctx.beginPath(),this.ctx.rect(0,0,s,i),this.ctx.fill(),this.$img.show()):a(new Image).attr("crossOrigin","").attr("src",this.options.fg).on("load",function(){t.ctx.drawImage(this,0,0,s,i),t.$img.show()}))},clear:function(){this.ctx.clearRect(0,0,Math.ceil(this.$el.innerWidth()),Math.ceil(this.$el.innerHeight()))},enable:function(t){this.enabled=!0===t},destroy:function(){this.$el.children().remove(),a.removeData(this.$el,"wScratchPad")},_setOptions:function(){var t,s;for(t in this.options)this.options[t]=this.$el.attr("data-"+t)||this.options[t],this[s="set"+t.charAt(0).toUpperCase()+t.substring(1)]&&this[s](this.options[t])},setBg:function(){this.init&&this.reset()},setFg:function(){this.setBg()},setCursor:function(t){this.$el.css("cursor",t)},_scratchFunc:function(t,s){t.pageX=Math.floor(t.pageX-this.canvasOffset.left),t.pageY=Math.floor(t.pageY-this.canvasOffset.top),this["_scratch"+s](t),(this.options.realtime||"Up"===s)&&this.options["scratch"+s]&&this.options["scratch"+s].apply(this,[t,this._scratchPercent()])},_scratchPercent:function(){for(var t=0,s=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),i=0,e=s.data.length;i<e;i+=4)0===s.data[i]&&0===s.data[i+1]&&0===s.data[i+2]&&0===s.data[i+3]&&t++;return t/this.pixels*100},_scratchDown:function(t){this.ctx.globalCompositeOperation="destination-out",this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.strokeStyle=this.options.color,this.ctx.lineWidth=this.options.size,this.ctx.beginPath(),this.ctx.arc(t.pageX,t.pageY,this.options.size/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(t.pageX,t.pageY),this.canvas.style.zIndex++},_scratchMove:function(t){this.ctx.lineTo(t.pageX,t.pageY),this.ctx.stroke(),this.canvas.style.zIndex++},_scratchUp:function(){this.ctx.closePath()}},a.support.canvas=document.createElement("canvas").getContext,a.fn.wScratchPad=function(s,t){var i,e,n,h,c;return"string"==typeof s?(e=[],n=(void 0!==t?"set":"get")+s.charAt(0).toUpperCase()+s.substring(1),h=function(){i.options[s]&&(i.options[s]=t),i[n]&&i[n].apply(i,[t])},c=function(){return i[n]?i[n].apply(i,[t]):i.options[s]||void 0},this.each(function(){(i=a.data(this,"wScratchPad"))&&(i[s]?i[s].apply(i,[t]):void 0!==t?h():e.push(c()))}),e.length?1===e.length?e[0]:e:this):(s=a.extend({},a.fn.wScratchPad.defaults,s),this.each(function(){var t=a.data(this,"wScratchPad");return t||(t=new o(this,a.extend(!0,{},s)),a.data(this,"wScratchPad",t)),t}))},a.fn.wScratchPad.defaults={size:5,bg:"#cacaca",fg:"#6699ff",realtime:!0,scratchDown:null,scratchUp:null,scratchMove:null,cursor:"crosshair"},a.fn.bindMobileEvents=function(){a(this).on("touchstart touchmove touchend touchcancel",function(t){var s=(t.changedTouches||t.originalEvent.targetTouches)[0],i="";switch(t.type){case"touchstart":i="mousedown";break;case"touchmove":i="mousemove",t.preventDefault();break;case"touchend":i="mouseup";break;default:return}var e=document.createEvent("MouseEvent");e.initMouseEvent(i,!0,!0,window,1,s.screenX,s.screenY,s.clientX,s.clientY,!1,!1,!1,!1,0,null),s.target.dispatchEvent(e)})}}(jQuery);